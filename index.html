<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>VertexScripts - Script Uploader & Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #0c2461 0%, #1e3799 100%);
            color: #fff;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            padding: 0 10px;
        }
        
        /* New Auth Styles */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }
        
        .auth-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .auth-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .auth-tab.active {
            color: #4bcffa;
            border-bottom: 2px solid #4bcffa;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .auth-error {
            color: #ff6b6b;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
        }
        
        .delete-account-btn {
            background: #ff6b6b;
            margin-top: 20px;
            width: 100%;
        }
        
        /* Dropdown Menu */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background: rgba(30, 30, 46, 0.95);
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            border-radius: 8px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 5px;
        }
        
        .dropdown-content a {
            color: white;
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.3s ease;
        }
        
        .dropdown-content a:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        /* Script View Modal */
        .script-view-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
            overflow-y: auto;
        }
        
        .script-view-content {
            background: #1a1a2e;
            border-radius: 15px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .script-view-header {
            padding: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .close-view {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }
        
        .close-view:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .script-view-body {
            padding: 25px;
        }
        
        .script-view-thumbnail {
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
        }
        
        .script-view-thumbnail img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        
        .video-player-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .video-player-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }
        
        /* YouTube Watch Options */
        .watch-options {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .watch-option-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .watch-option-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .watch-option-btn.active {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff0000;
        }
        
        .watch-here-btn.active {
            background: rgba(75, 207, 250, 0.2);
            border-color: #4bcffa;
        }
        
        .youtube-thumbnail {
            position: relative;
            cursor: pointer;
        }
        
        .youtube-thumbnail:hover .play-button {
            transform: scale(1.1);
        }
        
        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: rgba(255, 0, 0, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            transition: all 0.3s ease;
        }
        
        .script-view-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            align-items: center;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .like-btn, .dislike-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            padding: 5px;
            position: relative;
        }
        
        .like-btn:hover {
            color: #4bcffa;
        }
        
        .dislike-btn:hover {
            color: #ff6b6b;
        }
        
        .like-btn.liked {
            color: #4bcffa;
        }
        
        .dislike-btn.disliked {
            color: #ff6b6b;
        }
        
        .subscribe-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .subscribe-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .subscribe-btn.subscribed {
            background: #4bcffa;
            color: #0c2461;
        }
        
        /* Channel View Styles */
        .channel-container {
            display: none;
        }
        
        .channel-header {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .channel-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .channel-stat {
            text-align: center;
        }
        
        .channel-stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #4bcffa;
        }
        
        .channel-stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .channel-scripts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        /* Subscriptions Container */
        .subscriptions-container {
            display: none;
        }
        
        .subscriptions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        /* Pin Icon */
        .pin-icon {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ffd700;
            font-size: 1.2rem;
            z-index: 1;
        }
        
        .pin-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 5px;
        }
        
        .pin-btn.pinned {
            color: #ffd700;
        }
        
        /* Script Details in Card */
        .script-details {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .script-uploader {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 5px;
        }
        
        .script-uploader i {
            color: #4bcffa;
        }
        
        /* Mobile Dropdown Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 10px;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            .dropdown-btn {
                display: none;
            }
            
            .mobile-dropdown-content {
                display: none;
                position: fixed;
                top: 80px;
                left: 0;
                right: 0;
                background: rgba(30, 30, 46, 0.98);
                z-index: 1000;
                padding: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                max-height: calc(100vh - 80px);
                overflow-y: auto;
            }
            
            .mobile-dropdown-content.active {
                display: block;
            }
            
            .mobile-dropdown-content a {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 15px;
                color: white;
                text-decoration: none;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                font-size: 1rem;
            }
            
            .header-controls {
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .search-container {
                flex: 1;
            }
            
            /* Auto-show dropdown when clicking upload on mobile */
            .mobile-dropdown-content.show-upload {
                display: block;
            }
            
            .watch-options {
                flex-direction: column;
            }
            
            .watch-option-btn {
                min-width: 100%;
            }
        }
        
        /* Updated Header */
        header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 15px 0;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        @media (min-width: 768px) {
            header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 20px 0;
                margin-bottom: 30px;
            }
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .logo-section {
                width: auto;
            }
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Upload Options */
        .upload-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .upload-option-btn {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .upload-option-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .upload-option-btn.active {
            background: rgba(75, 207, 250, 0.2);
            border-color: #4bcffa;
        }
        
        .upload-option-btn i {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .youtube-preview {
            margin-top: 10px;
            display: none;
            text-align: center;
        }
        
        .youtube-preview iframe {
            width: 100%;
            max-width: 560px;
            height: 315px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Original Styles Continue Below */
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 1.8rem;
            color: #4bcffa;
        }
        
        .logo h1 {
            font-size: 1.6rem;
            background: linear-gradient(to right, #4bcffa, #5d79ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 0.5px;
        }
        
        @media (min-width: 768px) {
            .logo i {
                font-size: 2.5rem;
            }
            
            .logo h1 {
                font-size: 2.2rem;
            }
        }
        
        .header-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .header-controls {
                flex-direction: row;
                align-items: center;
                width: auto;
            }
        }
        
        .search-container {
            position: relative;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .search-container {
                width: auto;
            }
        }
        
        .search-input {
            padding: 12px 15px 12px 45px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            width: 100%;
            -webkit-appearance: none;
            font-size: 16px;
        }
        
        @media (min-width: 768px) {
            .search-input {
                width: 250px;
                padding: 10px 15px 10px 40px;
            }
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.6);
            pointer-events: none;
        }
        
        .upload-btn {
            background: linear-gradient(to right, #4bcffa, #5d79ff);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            font-size: 1rem;
            touch-action: manipulation;
        }
        
        @media (min-width: 768px) {
            .upload-btn {
                width: auto;
                padding: 10px 20px;
            }
        }
        
        .upload-btn:hover, .upload-btn:active {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(75, 207, 250, 0.3);
        }
        
        .credit {
            font-size: 0.9rem;
            opacity: 0.8;
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            text-align: center;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .credit {
                width: auto;
            }
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 1024px) {
            .main-content {
                gap: 30px;
                margin-bottom: 40px;
            }
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .card {
                padding: 25px;
            }
        }
        
        .card h2 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
        }
        
        @media (min-width: 768px) {
            .card h2 {
                margin-bottom: 20px;
                font-size: 1.6rem;
            }
        }
        
        .card h2 i {
            color: #4bcffa;
        }
        
        .dashboard-header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (min-width: 768px) {
            .dashboard-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 25px;
            }
        }
        
        .dashboard-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dashboard-stats {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .dashboard-stats {
                gap: 20px;
                justify-content: flex-start;
            }
        }
        
        .stat {
            text-align: center;
            min-width: 80px;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4bcffa;
        }
        
        @media (min-width: 768px) {
            .stat-number {
                font-size: 1.8rem;
            }
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        @media (min-width: 768px) {
            .stat-label {
                font-size: 0.9rem;
            }
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        @media (min-width: 768px) {
            .form-group {
                margin-bottom: 20px;
            }
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #ddd;
            font-size: 0.95rem;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            -webkit-appearance: none;
            min-height: 48px;
        }
        
        @media (min-width: 768px) {
            input, textarea {
                padding: 12px 15px;
            }
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #4bcffa;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            font-size: 16px;
        }
        
        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 48px;
        }
        
        .file-upload-label:hover, .file-upload-label:active {
            background: rgba(255, 255, 255, 0.15);
            border-color: #4bcffa;
        }
        
        .file-upload-label i {
            margin-right: 10px;
            font-size: 1.2rem;
            color: #4bcffa;
        }
        
        .thumbnail-preview {
            margin-top: 10px;
            display: none;
            text-align: center;
        }
        
        .thumbnail-preview img {
            max-width: 100%;
            max-height: 150px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .step-container {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            position: relative;
        }
        
        @media (min-width: 768px) {
            .step-container {
                margin-bottom: 15px;
            }
        }
        
        .step-container.vertex-step {
            background: rgba(75, 207, 250, 0.1);
            border: 1px solid rgba(75, 207, 250, 0.3);
        }
        
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .step-title {
            font-weight: 600;
            color: #4bcffa;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .step-title i {
            color: #ff6b6b;
        }
        
        .vertex-step .step-title i {
            color: #4bcffa;
        }
        
        .remove-step {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            cursor: pointer;
            min-height: 32px;
            touch-action: manipulation;
        }
        
        .vertex-step .remove-step {
            display: none !important;
        }
        
        .step-url {
            background: rgba(255, 255, 255, 0.05) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            width: 100%;
            margin-top: 5px;
        }
        
        .vertex-step .step-url {
            background: rgba(0, 0, 0, 0.2) !important;
            color: rgba(255, 255, 255, 0.7) !important;
            cursor: not-allowed;
        }
        
        .btn {
            background: linear-gradient(to right, #4bcffa, #5d79ff);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            font-size: 1rem;
            touch-action: manipulation;
        }
        
        @media (min-width: 768px) {
            .btn {
                width: auto;
                padding: 12px 25px;
            }
        }
        
        .btn:hover, .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(75, 207, 250, 0.3);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .btn-secondary:hover, .btn-secondary:active {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-danger {
            background: #ff6b6b;
        }
        
        .btn-danger:hover, .btn-danger:active {
            background: #ff5252;
        }
        
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        @media (min-width: 768px) {
            .button-group {
                flex-direction: row;
                gap: 10px;
                margin-top: 10px;
            }
        }
        
        .scripts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        @media (min-width: 640px) {
            .scripts-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 20px;
            }
        }
        
        @media (min-width: 1024px) {
            .scripts-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 25px;
            }
        }
        
        .script-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .script-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .script-card-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 2;
        }
        
        .script-card:hover .script-card-actions {
            opacity: 1;
        }
        
        @media (hover: none) {
            .script-card-actions {
                opacity: 1;
            }
        }
        
        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }
        
        .action-btn:hover, .action-btn:active {
            transform: scale(1.1);
        }
        
        .delete-btn:hover, .delete-btn:active {
            background: #ff6b6b;
        }
        
        .edit-btn:hover, .edit-btn:active {
            background: #4bcffa;
        }
        
        .script-thumbnail {
            height: 160px;
            width: 100%;
            background: linear-gradient(45deg, #0c2461, #1e3799);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4bcffa;
            font-size: 2.5rem;
        }
        
        @media (min-width: 768px) {
            .script-thumbnail {
                height: 180px;
                font-size: 3rem;
            }
        }
        
        .script-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .script-info {
            padding: 15px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        @media (min-width: 768px) {
            .script-info {
                padding: 20px;
            }
        }
        
        .script-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .script-title {
                font-size: 1.3rem;
            }
        }
        
        .script-author {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .script-meta {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .steps-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
        }
        
        @media (min-width: 768px) {
            .step-dot {
                width: 10px;
                height: 10px;
            }
        }
        
        .step-dot.active {
            background: #4bcffa;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        
        .modal-content {
            background: #1a1a2e;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (min-width: 768px) {
            .modal-content {
                padding: 30px;
            }
        }
        
        .modal h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
            color: #4bcffa;
            word-break: break-word;
        }
        
        @media (min-width: 768px) {
            .modal h3 {
                font-size: 1.8rem;
                margin-bottom: 20px;
            }
        }
        
        .timer {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 20px 0;
            color: #4bcffa;
        }
        
        @media (min-width: 768px) {
            .timer {
                font-size: 3rem;
                margin: 25px 0;
            }
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .progress-bar {
                margin: 20px 0;
            }
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #4bcffa, #5d79ff);
            width: 0%;
            transition: width 1s linear;
        }
        
        .step-check {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            transition: opacity 0.3s ease;
            text-align: left;
        }
        
        .step-check.completed {
            opacity: 0.85;
        }
        
        .step-check.completed .check-circle {
            border-color: #4bcffa;
        }
        
        .step-check.completed .check-circle i {
            opacity: 1;
        }
        
        .step-check.in-progress .check-circle {
            border-color: #4bcffa;
            border-top-color: transparent;
        }
        
        .check-circle {
            min-width: 40px;
            min-height: 40px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        @media (min-width: 768px) {
            .check-circle {
                min-width: 50px;
                min-height: 50px;
                width: 50px;
                height: 50px;
                margin-right: 15px;
            }
        }
        
        .check-circle.spinning {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .check-circle i {
            color: #4bcffa;
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        @media (min-width: 768px) {
            .check-circle i {
                font-size: 1.5rem;
            }
        }
        
        .step-text {
            text-align: left;
            flex: 1;
            overflow: hidden;
        }
        
        .step-name {
            font-weight: 600;
            margin-bottom: 5px;
            word-break: break-word;
        }
        
        .step-desc {
            font-size: 0.85rem;
            opacity: 0.8;
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        @media (min-width: 768px) {
            .step-desc {
                font-size: 0.9rem;
            }
        }
        
        .step-link-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            margin-top: 8px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            touch-action: manipulation;
        }
        
        @media (min-width: 768px) {
            .step-link-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
        }
        
        .step-link-btn:hover, .step-link-btn:active {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .step-link-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .unlock-btn {
            background: #00b894;
            margin-top: 20px;
            width: 100%;
        }
        
        .unlock-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            opacity: 0.7;
            grid-column: 1 / -1;
        }
        
        @media (min-width: 768px) {
            .empty-state {
                padding: 60px 20px;
            }
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #4bcffa;
        }
        
        @media (min-width: 768px) {
            .empty-state i {
                font-size: 4rem;
                margin-bottom: 20px;
            }
        }
        
        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        @media (min-width: 768px) {
            .empty-state h3 {
                font-size: 1.5rem;
            }
        }
        
        .upload-container {
            display: none;
        }
        
        .back-to-dashboard {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            width: 100%;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .back-to-dashboard {
                width: auto;
                padding: 10px 20px;
                justify-content: flex-start;
            }
        }
        
        .back-to-dashboard:hover, .back-to-dashboard:active {
            background: rgba(255, 255, 255, 0.2);
        }
        
        footer {
            text-align: center;
            padding: 20px 10px;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
            width: 100%;
        }
        
        .step-counter {
            display: inline-block;
            background: #4bcffa;
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            text-align: center;
            line-height: 22px;
            font-size: 0.75rem;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        @media (min-width: 768px) {
            .step-counter {
                width: 24px;
                height: 24px;
                line-height: 24px;
                font-size: 0.8rem;
            }
        }
        
        .user-id-display {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            word-break: break-all;
        }
        
        /* Mobile optimizations */
        @media (max-width: 767px) {
            .hide-on-mobile {
                display: none !important;
            }
            
            .mobile-full-width {
                width: 100% !important;
            }
            
            .mobile-stack {
                flex-direction: column !important;
            }
        }
        
        /* Prevent text size adjustment on orientation change */
        html {
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }
        
        /* Improve touch scrolling */
        .modal-content, #stepChecks {
            -webkit-overflow-scrolling: touch;
        }
        
        /* Loading animation for better UX */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #4bcffa;
            animation: spin 1s ease-in-out infinite;
        }
        
        /* Swipe gestures support */
        @media (hover: none) and (pointer: coarse) {
            .script-card {
                cursor: pointer;
            }
            
            .btn, .upload-btn, .action-btn {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        /* Toast styles */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 14px;
            animation: fadeInOut 3s ease;
            max-width: 90%;
            text-align: center;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(20px); }
            15% { opacity: 1; transform: translateX(-50%) translateY(0); }
            85% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }
        
        /* Like/Dislike Animation */
        .like-btn .count, .dislike-btn .count {
            transition: transform 0.3s ease;
        }
        
        .like-btn.liked .count, .dislike-btn.disliked .count {
            animation: pulse 0.5s ease;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* Disabled state for rapid clicking */
        .like-btn:disabled, .dislike-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- Authentication Container -->
    <div id="authContainer" class="auth-container">
        <div class="auth-card">
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">Login</button>
                <button class="auth-tab" id="registerTab">Register</button>
            </div>
            
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter username" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password" required>
                </div>
                
                <div class="auth-error" id="loginError"></div>
                
                <button type="submit" class="btn">Login</button>
            </form>
            
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" placeholder="Choose username" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Choose password" required>
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm password" required>
                </div>
                
                <div class="auth-error" id="registerError"></div>
                
                <button type="submit" class="btn">Register</button>
            </form>
        </div>
    </div>
    
    <!-- Main Application Container -->
    <div id="appContainer" style="display: none;">
        <div class="container">
            <header>
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-code"></i>
                        <h1>VertexScripts</h1>
                    </div>
                    
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <div class="user-info">
                        <span id="currentUserDisplay"></span>
                        <div class="dropdown">
                            <button class="dropdown-btn">
                                <i class="fas fa-user-circle"></i>
                                <span id="usernameDisplay"></span>
                                <i class="fas fa-caret-down"></i>
                            </button>
                            <div class="dropdown-content">
                                <a href="#" id="viewChannelBtn">
                                    <i class="fas fa-user"></i> My Channel
                                </a>
                                <a href="#" id="subscriptionsBtn">
                                    <i class="fas fa-bell"></i> Subscriptions
                                </a>
                                <a href="#" id="deleteAccountBtn">
                                    <i class="fas fa-trash"></i> Delete Account
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mobile-dropdown-content" id="mobileDropdown">
                    <a href="#" id="mobileViewChannelBtn">
                        <i class="fas fa-user"></i> My Channel
                    </a>
                    <a href="#" id="mobileSubscriptionsBtn">
                        <i class="fas fa-bell"></i> Subscriptions
                    </a>
                    <a href="#" id="mobileDeleteAccountBtn">
                        <i class="fas fa-trash"></i> Delete Account
                    </a>
                </div>
                
                <div class="header-controls">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="searchInput" placeholder="Search scripts...">
                    </div>
                    <button class="upload-btn" id="showUploadBtn">
                        <i class="fas fa-upload"></i> Upload Script
                    </button>
                    <div class="credit">VertexScripts</div>
                </div>
            </header>
            
            <main class="main-content">
                <!-- Channel View Section -->
                <section id="channelContainer" class="card channel-container">
                    <button class="back-to-dashboard" id="backToDashboardFromChannel">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    
                    <div class="channel-header">
                        <h2><i class="fas fa-user"></i> My Channel</h2>
                        <p>Welcome to your channel, <span id="channelUsername"></span>!</p>
                        
                        <div class="channel-stats">
                            <div class="channel-stat">
                                <div class="channel-stat-number" id="channelSubscribers">0</div>
                                <div class="channel-stat-label">Subscribers</div>
                            </div>
                            <div class="channel-stat">
                                <div class="channel-stat-number" id="channelTotalLikes">0</div>
                                <div class="channel-stat-label">Total Likes</div>
                            </div>
                            <div class="channel-stat">
                                <div class="channel-stat-number" id="channelTotalViews">0</div>
                                <div class="channel-stat-label">Total Views</div>
                            </div>
                            <div class="channel-stat">
                                <div class="channel-stat-number" id="channelScriptsCount">0</div>
                                <div class="channel-stat-label">Scripts</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3><i class="fas fa-code"></i> My Scripts</h3>
                    
                    <div id="channelScriptsList" class="channel-scripts-grid">
                        <!-- User's scripts will be dynamically added here -->
                    </div>
                </section>
                
                <!-- Subscriptions Section -->
                <section id="subscriptionsContainer" class="card subscriptions-container">
                    <button class="back-to-dashboard" id="backToDashboardFromSubs">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    
                    <h2><i class="fas fa-bell"></i> Subscriptions</h2>
                    <p>Latest scripts from creators you follow</p>
                    
                    <div id="subscriptionsList" class="subscriptions-grid">
                        <!-- Subscription scripts will be dynamically added here -->
                    </div>
                </section>
                
                <!-- Dashboard Section -->
                <section id="dashboardContainer" class="card">
                    <div class="dashboard-header">
                        <div class="dashboard-title">
                            <h2><i class="fas fa-tachometer-alt"></i> Script Dashboard</h2>
                        </div>
                        <div class="dashboard-stats">
                            <div class="stat">
                                <div class="stat-number" id="totalScripts">0</div>
                                <div class="stat-label">Total Scripts</div>
                            </div>
                            <div class="stat">
                                <div class="stat-number" id="myScripts">0</div>
                                <div class="stat-label">My Scripts</div>
                            </div>
                        </div>
                    </div>
                    <p>Browse and manage all available scripts</p>
                    
                    <div id="scriptsList" class="scripts-grid">
                        <!-- Scripts will be dynamically added here -->
                    </div>
                </section>
                
                <!-- Upload Script Section -->
                <section id="uploadContainer" class="card upload-container">
                    <button class="back-to-dashboard" id="backToDashboardBtn">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    
                    <h2><i class="fas fa-upload"></i> Upload New Script</h2>
                    <form id="uploadForm">
                        <div class="form-group">
                            <label for="scriptName">Script Name</label>
                            <input type="text" id="scriptName" placeholder="Enter script name" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Script Thumbnail</label>
                            <div class="upload-options">
                                <button type="button" class="upload-option-btn active" id="thumbnailOptionBtn">
                                    <i class="fas fa-image"></i>
                                    <span>Upload Image</span>
                                </button>
                                <button type="button" class="upload-option-btn" id="youtubeOptionBtn">
                                    <i class="fab fa-youtube"></i>
                                    <span>YouTube Video</span>
                                </button>
                            </div>
                            
                            <!-- Image Upload Option -->
                            <div id="thumbnailUploadSection" class="thumbnail-section">
                                <div class="file-upload">
                                    <label for="thumbnailInput" class="file-upload-label">
                                        <i class="fas fa-image"></i>
                                        <span id="fileLabelText">Click to upload thumbnail image</span>
                                    </label>
                                    <input type="file" id="thumbnailInput" accept="image/*">
                                </div>
                                <div class="thumbnail-preview" id="thumbnailPreview">
                                    <img id="previewImage" src="" alt="Thumbnail Preview">
                                </div>
                            </div>
                            
                            <!-- YouTube Option -->
                            <div id="youtubeUploadSection" class="youtube-section" style="display: none;">
                                <input type="text" id="youtubeLink" placeholder="Enter YouTube video URL (e.g., https://youtube.com/watch?v=...)">
                                <div class="youtube-preview" id="youtubePreview">
                                    <!-- YouTube preview will be shown here -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="scriptLink">Script Download Link</label>
                            <input type="text" id="scriptLink" placeholder="https://example.com/script.zip" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Unlock Steps (Users must complete these before accessing your script)</label>
                            <div id="stepsContainer">
                                <!-- Vertex step is added by default and cannot be removed -->
                            </div>
                            
                            <div class="button-group">
                                <button type="button" id="addStepBtn" class="btn btn-secondary">
                                    <i class="fas fa-plus"></i> Add Step
                                </button>
                                <button type="button" id="addYoutubeStepBtn" class="btn btn-secondary">
                                    <i class="fab fa-youtube"></i> Add YouTube Step
                                </button>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn mobile-full-width">
                            <i class="fas fa-cloud-upload-alt"></i> Upload Script
                        </button>
                    </form>
                </section>
            </main>
            
            <!-- Unlock Modal -->
            <div id="unlockModal" class="modal">
                <div class="modal-content">
                    <h3>Unlock Script: <span id="unlockScriptName"></span></h3>
                    <p>Complete all steps to unlock the script</p>
                    
                    <div id="stepChecks">
                        <!-- Step checks will be dynamically added here -->
                    </div>
                    
                    <div class="progress-bar">
                        <div id="progress" class="progress"></div>
                    </div>
                    
                    <div class="timer" id="timer">20</div>
                    
                    <button id="accessLinkBtn" class="btn unlock-btn" disabled>
                        <i class="fas fa-lock"></i> Unlocking... Please wait
                    </button>
                    
                    <button id="cancelBtn" class="btn btn-secondary" style="margin-top: 10px;">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
            
            <!-- Script View Modal -->
            <div id="scriptViewModal" class="modal script-view-modal">
                <div class="script-view-content">
                    <div class="script-view-header">
                        <h3 id="viewScriptName"></h3>
                        <button class="close-view" id="closeScriptView">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="script-view-body">
                        <div id="videoContent">
                            <!-- Video content will be dynamically added here -->
                        </div>
                        
                        <div class="watch-options" id="watchOptions" style="display: none;">
                            <button class="watch-option-btn watch-here-btn active" id="watchHereBtn">
                                <i class="fas fa-play-circle"></i> Watch Here
                            </button>
                            <button class="watch-option-btn" id="watchYouTubeBtn">
                                <i class="fab fa-youtube"></i> Watch on YouTube
                            </button>
                        </div>
                        
                        <div class="script-details">
                            <div class="script-uploader">
                                <i class="fas fa-user"></i>
                                <span id="viewScriptAuthor"></span>
                                <span id="viewScriptDate"></span>
                            </div>
                        </div>
                        
                        <div class="script-view-stats">
                            <div class="stat-item">
                                <button class="like-btn" id="viewLikeBtn">
                                    <i class="fas fa-thumbs-up"></i>
                                    <span class="count" id="viewLikeCount">0</span>
                                </button>
                            </div>
                            <div class="stat-item">
                                <button class="dislike-btn" id="viewDislikeBtn">
                                    <i class="fas fa-thumbs-down"></i>
                                    <span class="count" id="viewDislikeCount">0</span>
                                </button>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-eye"></i>
                                <span id="viewViewCount">0</span> views
                            </div>
                            <button class="subscribe-btn" id="viewSubscribeBtn">
                                <i class="fas fa-bell"></i>
                                <span id="subscribeText">Subscribe</span>
                            </button>
                        </div>
                        
                        <button class="btn" id="viewUnlockBtn">
                            <i class="fas fa-unlock-alt"></i> Unlock Script
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Delete Confirmation Modal -->
            <div id="deleteModal" class="modal">
                <div class="modal-content">
                    <h3><i class="fas fa-exclamation-triangle" style="color: #ff6b6b;"></i> Confirm Delete</h3>
                    <p id="deleteMessage">Are you sure you want to delete this script? This action cannot be undone.</p>
                    
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 25px;">
                        <button id="confirmDeleteBtn" class="btn btn-danger mobile-full-width">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                        <button id="cancelDeleteBtn" class="btn btn-secondary mobile-full-width">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Delete Account Modal -->
            <div id="deleteAccountModal" class="modal">
                <div class="modal-content">
                    <h3><i class="fas fa-exclamation-triangle" style="color: #ff6b6b;"></i> Delete Account</h3>
                    <p>This will permanently delete your account, all your uploaded scripts, subscriptions, likes, and everything associated with your account. This action cannot be undone!</p>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="confirmUsername">Type your username to confirm</label>
                        <input type="text" id="confirmUsername" placeholder="Enter your username">
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 25px;">
                        <button id="confirmAccountDeleteBtn" class="btn btn-danger mobile-full-width">
                            <i class="fas fa-trash"></i> Permanently Delete Account
                        </button>
                        <button id="cancelAccountDeleteBtn" class="btn btn-secondary mobile-full-width">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <footer>
                <p>VertexScripts Dashboard &copy; 2023 | All scripts are property of their respective owners</p>
            </footer>
        </div>
    </div>

    <script>
        // ============ ENHANCED STORAGE SYSTEM ============
        class VertexStorage {
            constructor() {
                this.initStorage();
            }
            
            initStorage() {
                // Initialize all storage keys
                if (!localStorage.getItem('vertex_users')) {
                    localStorage.setItem('vertex_users', JSON.stringify({}));
                }
                if (!localStorage.getItem('vertex_scripts')) {
                    localStorage.setItem('vertex_scripts', JSON.stringify([]));
                }
                if (!localStorage.getItem('vertex_interactions')) {
                    localStorage.setItem('vertex_interactions', JSON.stringify({}));
                }
                if (!localStorage.getItem('vertex_subscriptions')) {
                    localStorage.setItem('vertex_subscriptions', JSON.stringify({}));
                }
                if (!localStorage.getItem('vertex_current_user')) {
                    localStorage.setItem('vertex_current_user', JSON.stringify(null));
                }
                if (!localStorage.getItem('vertex_ratelimits')) {
                    localStorage.setItem('vertex_ratelimits', JSON.stringify({}));
                }
            }
            
            // User management
            registerUser(username, password) {
                const users = JSON.parse(localStorage.getItem('vertex_users'));
                
                if (users[username]) {
                    return { success: false, error: 'Username already exists' };
                }
                
                if (password === username) {
                    return { success: false, error: 'Password cannot be the same as username' };
                }
                
                if (password.length < 6) {
                    return { success: false, error: 'Password must be at least 6 characters' };
                }
                
                const hashedPassword = this.hashPassword(password);
                
                users[username] = {
                    username: username,
                    password: hashedPassword,
                    createdAt: new Date().toISOString(),
                    isAdmin: username === 'plstealme2'
                };
                
                localStorage.setItem('vertex_users', JSON.stringify(users));
                return { success: true };
            }
            
            loginUser(username, password) {
                const users = JSON.parse(localStorage.getItem('vertex_users'));
                
                if (!users[username]) {
                    return { success: false, error: 'Invalid username or password' };
                }
                
                const hashedPassword = this.hashPassword(password);
                if (users[username].password !== hashedPassword) {
                    return { success: false, error: 'Invalid username or password' };
                }
                
                return { success: true, user: users[username] };
            }
            
            hashPassword(password) {
                let hash = 0;
                for (let i = 0; i < password.length; i++) {
                    const char = password.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString();
            }
            
            setCurrentUser(username) {
                localStorage.setItem('vertex_current_user', JSON.stringify(username));
            }
            
            getCurrentUser() {
                const username = JSON.parse(localStorage.getItem('vertex_current_user'));
                if (!username) return null;
                
                const users = JSON.parse(localStorage.getItem('vertex_users'));
                return users[username] || null;
            }
            
            logoutUser() {
                localStorage.setItem('vertex_current_user', JSON.stringify(null));
            }
            
            deleteUser(username) {
                const users = JSON.parse(localStorage.getItem('vertex_users'));
                delete users[username];
                localStorage.setItem('vertex_users', JSON.stringify(users));
                
                // Delete user's scripts
                let scripts = JSON.parse(localStorage.getItem('vertex_scripts'));
                scripts = scripts.filter(script => script.uploader !== username);
                localStorage.setItem('vertex_scripts', JSON.stringify(scripts));
                
                // Delete user's subscriptions
                const subscriptions = JSON.parse(localStorage.getItem('vertex_subscriptions'));
                delete subscriptions[username];
                localStorage.setItem('vertex_subscriptions', JSON.stringify(subscriptions));
                
                // Delete user's interactions
                const interactions = JSON.parse(localStorage.getItem('vertex_interactions'));
                delete interactions[username];
                localStorage.setItem('vertex_interactions', JSON.stringify(interactions));
                
                // Delete user's rate limits
                const rateLimits = JSON.parse(localStorage.getItem('vertex_ratelimits'));
                delete rateLimits[username];
                localStorage.setItem('vertex_ratelimits', JSON.stringify(rateLimits));
                
                // Remove as subscriber from other users
                Object.keys(subscriptions).forEach(user => {
                    if (subscriptions[user] && subscriptions[user].includes(username)) {
                        const index = subscriptions[user].indexOf(username);
                        if (index > -1) {
                            subscriptions[user].splice(index, 1);
                        }
                    }
                });
                
                localStorage.setItem('vertex_subscriptions', JSON.stringify(subscriptions));
                this.logoutUser();
            }
            
            // Script management
            saveScript(script) {
                let scripts = JSON.parse(localStorage.getItem('vertex_scripts'));
                scripts.push(script);
                localStorage.setItem('vertex_scripts', JSON.stringify(scripts));
            }
            
            getScripts() {
                return JSON.parse(localStorage.getItem('vertex_scripts'));
            }
            
            getScriptsByUser(username) {
                const scripts = this.getScripts();
                return scripts.filter(script => script.uploader === username);
            }
            
            deleteScript(scriptId) {
                let scripts = JSON.parse(localStorage.getItem('vertex_scripts'));
                scripts = scripts.filter(script => script.id !== scriptId);
                localStorage.setItem('vertex_scripts', JSON.stringify(scripts));
            }
            
            updateScript(updatedScript) {
                let scripts = JSON.parse(localStorage.getItem('vertex_scripts'));
                const index = scripts.findIndex(script => script.id === updatedScript.id);
                if (index !== -1) {
                    scripts[index] = updatedScript;
                    localStorage.setItem('vertex_scripts', JSON.stringify(scripts));
                }
            }
            
            // Advanced interaction tracking with rate limiting
            recordInteraction(username, scriptId, type) {
                // Check rate limit
                if (!this.checkRateLimit(username, scriptId, type)) {
                    return { success: false, error: 'Please wait before interacting again' };
                }
                
                let interactions = JSON.parse(localStorage.getItem('vertex_interactions'));
                
                if (!interactions[username]) {
                    interactions[username] = {};
                }
                
                if (!interactions[username][scriptId]) {
                    interactions[username][scriptId] = {};
                }
                
                // Get current interaction state
                const currentLike = interactions[username][scriptId]['like'] || false;
                const currentDislike = interactions[username][scriptId]['dislike'] || false;
                
                // Determine the action
                const isLiking = type === 'like';
                const isCurrentlyLiked = currentLike;
                const isCurrentlyDisliked = currentDislike;
                
                // Update interaction
                if (isLiking) {
                    // If already liked, remove like
                    if (isCurrentlyLiked) {
                        delete interactions[username][scriptId]['like'];
                    } else {
                        // Add like and remove dislike if it exists
                        interactions[username][scriptId]['like'] = true;
                        if (isCurrentlyDisliked) {
                            delete interactions[username][scriptId]['dislike'];
                        }
                    }
                } else {
                    // If already disliked, remove dislike
                    if (isCurrentlyDisliked) {
                        delete interactions[username][scriptId]['dislike'];
                    } else {
                        // Add dislike and remove like if it exists
                        interactions[username][scriptId]['dislike'] = true;
                        if (isCurrentlyLiked) {
                            delete interactions[username][scriptId]['like'];
                        }
                    }
                }
                
                localStorage.setItem('vertex_interactions', JSON.stringify(interactions));
                
                // Update rate limit
                this.updateRateLimit(username, scriptId, type);
                
                // Return current state
                const newLikeState = interactions[username][scriptId]['like'] || false;
                const newDislikeState = interactions[username][scriptId]['dislike'] || false;
                
                return { 
                    success: true, 
                    liked: newLikeState, 
                    disliked: newDislikeState,
                    wasLiked: currentLike,
                    wasDisliked: currentDislike
                };
            }
            
            // Rate limiting to prevent spam
            checkRateLimit(username, scriptId, type) {
                const rateLimits = JSON.parse(localStorage.getItem('vertex_ratelimits'));
                const key = `${username}_${scriptId}_${type}`;
                const now = Date.now();
                
                if (!rateLimits[key]) return true;
                
                const lastInteraction = rateLimits[key];
                const timeSinceLast = now - lastInteraction;
                
                // 1 second cooldown between interactions
                return timeSinceLast > 1000;
            }
            
            updateRateLimit(username, scriptId, type) {
                const rateLimits = JSON.parse(localStorage.getItem('vertex_ratelimits'));
                const key = `${username}_${scriptId}_${type}`;
                rateLimits[key] = Date.now();
                localStorage.setItem('vertex_ratelimits', JSON.stringify(rateLimits));
            }
            
            hasInteracted(username, scriptId, type) {
                const interactions = JSON.parse(localStorage.getItem('vertex_interactions'));
                return interactions[username] && 
                       interactions[username][scriptId] && 
                       interactions[username][scriptId][type];
            }
            
            getInteractionState(username, scriptId) {
                const interactions = JSON.parse(localStorage.getItem('vertex_interactions'));
                if (!interactions[username] || !interactions[username][scriptId]) {
                    return { liked: false, disliked: false };
                }
                return {
                    liked: interactions[username][scriptId]['like'] || false,
                    disliked: interactions[username][scriptId]['dislike'] || false
                };
            }
            
            // Subscription management
            subscribe(subscriber, creator) {
                if (subscriber === creator) return false;
                
                let subscriptions = JSON.parse(localStorage.getItem('vertex_subscriptions'));
                
                if (!subscriptions[subscriber]) {
                    subscriptions[subscriber] = [];
                }
                
                // Toggle subscription
                if (subscriptions[subscriber].includes(creator)) {
                    const index = subscriptions[subscriber].indexOf(creator);
                    subscriptions[subscriber].splice(index, 1);
                    localStorage.setItem('vertex_subscriptions', JSON.stringify(subscriptions));
                    return false; // Unsubscribed
                } else {
                    subscriptions[subscriber].push(creator);
                    localStorage.setItem('vertex_subscriptions', JSON.stringify(subscriptions));
                    return true; // Subscribed
                }
            }
            
            isSubscribed(subscriber, creator) {
                const subscriptions = JSON.parse(localStorage.getItem('vertex_subscriptions'));
                return subscriptions[subscriber] && subscriptions[subscriber].includes(creator);
            }
            
            getSubscriptions(username) {
                const subscriptions = JSON.parse(localStorage.getItem('vertex_subscriptions'));
                return subscriptions[username] || [];
            }
            
            getSubscribers(username) {
                const subscriptions = JSON.parse(localStorage.getItem('vertex_subscriptions'));
                const subscribers = [];
                
                Object.keys(subscriptions).forEach(subscriber => {
                    if (subscriptions[subscriber] && subscriptions[subscriber].includes(username)) {
                        subscribers.push(subscriber);
                    }
                });
                
                return subscribers;
            }
            
            // Channel stats
            getUserChannelStats(username) {
                const scripts = this.getScriptsByUser(username);
                let totalLikes = 0;
                let totalDislikes = 0;
                let totalViews = 0;
                
                scripts.forEach(script => {
                    totalLikes += script.likes || 0;
                    totalDislikes += script.dislikes || 0;
                    totalViews += script.views || 0;
                });
                
                const subscribers = this.getSubscribers(username);
                
                return {
                    scriptsCount: scripts.length,
                    totalLikes,
                    totalDislikes,
                    totalViews,
                    subscribers: subscribers.length,
                    subscriberList: subscribers
                };
            }
        }

        // ============ MAIN APPLICATION ============
        const storage = new VertexStorage();
        let currentUser = null;
        let scripts = [];
        let nextId = 1;
        let currentUnlockScript = null;
        let currentStep = 0;
        let countdown = 20;
        let countdownInterval = null;
        let completedSteps = new Set();
        let stepTimers = {};
        let scriptToDelete = null;
        let currentViewScript = null;
        let uploadType = 'thumbnail'; // 'thumbnail' or 'youtube'
        let currentWatchOption = 'watch-here'; // 'watch-here' or 'watch-youtube'

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            currentUser = storage.getCurrentUser();
            
            if (currentUser) {
                showApp();
            } else {
                showAuth();
            }
            
            setupEventListeners();
            loadScripts();
            updateStats();
        });

        function setupEventListeners() {
            // Auth tabs
            document.getElementById('loginTab').addEventListener('click', () => switchAuthTab('login'));
            document.getElementById('registerTab').addEventListener('click', () => switchAuthTab('register'));
            
            // Auth forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            
            // Upload type selection
            document.getElementById('thumbnailOptionBtn').addEventListener('click', () => switchUploadType('thumbnail'));
            document.getElementById('youtubeOptionBtn').addEventListener('click', () => switchUploadType('youtube'));
            
            // YouTube link preview
            document.getElementById('youtubeLink').addEventListener('input', handleYoutubeLink);
            
            // Main app buttons
            document.getElementById('uploadForm').addEventListener('submit', uploadScript);
            document.getElementById('addStepBtn').addEventListener('click', addStep);
            document.getElementById('addYoutubeStepBtn').addEventListener('click', addYouTubeStep);
            document.getElementById('thumbnailInput').addEventListener('change', handleThumbnailPreview);
            document.getElementById('cancelBtn').addEventListener('click', closeUnlockModal);
            document.getElementById('accessLinkBtn').addEventListener('click', accessScriptLink);
            document.getElementById('showUploadBtn').addEventListener('click', showUploadForm);
            document.getElementById('backToDashboardBtn').addEventListener('click', showDashboard);
            document.getElementById('searchInput').addEventListener('input', filterScripts);
            document.getElementById('confirmDeleteBtn').addEventListener('click', confirmDeleteScript);
            document.getElementById('cancelDeleteBtn').addEventListener('click', cancelDelete);
            document.getElementById('confirmAccountDeleteBtn').addEventListener('click', confirmAccountDelete);
            document.getElementById('cancelAccountDeleteBtn').addEventListener('click', cancelAccountDelete);
            document.getElementById('viewChannelBtn').addEventListener('click', showChannel);
            document.getElementById('mobileViewChannelBtn').addEventListener('click', showChannel);
            document.getElementById('subscriptionsBtn').addEventListener('click', showSubscriptions);
            document.getElementById('mobileSubscriptionsBtn').addEventListener('click', showSubscriptions);
            document.getElementById('backToDashboardFromSubs').addEventListener('click', showDashboard);
            document.getElementById('backToDashboardFromChannel').addEventListener('click', showDashboard);
            document.getElementById('deleteAccountBtn').addEventListener('click', showDeleteAccountModal);
            document.getElementById('mobileDeleteAccountBtn').addEventListener('click', showDeleteAccountModal);
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            document.getElementById('closeScriptView').addEventListener('click', closeScriptView);
            document.getElementById('viewUnlockBtn').addEventListener('click', unlockFromView);
            
            // Watch options
            document.getElementById('watchHereBtn').addEventListener('click', () => switchWatchOption('watch-here'));
            document.getElementById('watchYouTubeBtn').addEventListener('click', () => switchWatchOption('watch-youtube'));
            
            // Advanced like/dislike handling
            document.getElementById('viewLikeBtn').addEventListener('click', handleLike);
            document.getElementById('viewDislikeBtn').addEventListener('click', handleDislike);
            document.getElementById('viewSubscribeBtn').addEventListener('click', handleSubscribe);
            
            // Window events
            window.addEventListener('orientationchange', () => setTimeout(handleResize, 100));
            window.addEventListener('resize', debounce(handleResize, 250));
            window.addEventListener('click', closeMobileMenuOnClickOutside);
            
            // Initialize
            addVertexStep();
            handleResize();
        }

        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            
            if (tab === 'login') {
                document.getElementById('loginTab').classList.add('active');
                document.getElementById('loginForm').classList.add('active');
            } else {
                document.getElementById('registerTab').classList.add('active');
                document.getElementById('registerForm').classList.add('active');
            }
        }

        function switchUploadType(type) {
            uploadType = type;
            
            // Update button states
            document.getElementById('thumbnailOptionBtn').classList.toggle('active', type === 'thumbnail');
            document.getElementById('youtubeOptionBtn').classList.toggle('active', type === 'youtube');
            
            // Show/hide sections
            document.getElementById('thumbnailUploadSection').style.display = type === 'thumbnail' ? 'block' : 'none';
            document.getElementById('youtubeUploadSection').style.display = type === 'youtube' ? 'block' : 'none';
            
            // Update required attribute
            document.getElementById('thumbnailInput').required = type === 'thumbnail';
            document.getElementById('youtubeLink').required = type === 'youtube';
        }

        function switchWatchOption(option) {
            currentWatchOption = option;
            
            // Update button states
            document.getElementById('watchHereBtn').classList.toggle('active', option === 'watch-here');
            document.getElementById('watchYouTubeBtn').classList.toggle('active', option === 'watch-youtube');
            
            // Update video content based on option
            updateVideoContent();
        }

        function updateVideoContent() {
            const videoContent = document.getElementById('videoContent');
            if (!currentViewScript || !currentViewScript.youtubeVideo) return;
            
            const videoId = extractYoutubeVideoId(currentViewScript.youtubeVideo);
            
            if (currentWatchOption === 'watch-here') {
                // Embed YouTube video
                videoContent.innerHTML = `
                    <div class="video-player-container">
                        <iframe 
                            src="https://www.youtube.com/embed/${videoId}?autoplay=1" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>
                `;
            } else {
                // Show thumbnail with play button that opens YouTube
                videoContent.innerHTML = `
                    <div class="script-view-thumbnail youtube-thumbnail" onclick="window.open('${currentViewScript.youtubeVideo}', '_blank')">
                        <img src="https://img.youtube.com/vi/${videoId}/maxresdefault.jpg" alt="YouTube Video">
                        <div class="play-button">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                `;
            }
        }

        function handleYoutubeLink(e) {
            const youtubeLink = e.target.value;
            const youtubePreview = document.getElementById('youtubePreview');
            
            if (!youtubeLink) {
                youtubePreview.style.display = 'none';
                return;
            }
            
            // Extract video ID from YouTube URL
            const videoId = extractYoutubeVideoId(youtubeLink);
            
            if (videoId) {
                youtubePreview.innerHTML = `
                    <div class="video-player-container">
                        <iframe 
                            src="https://www.youtube.com/embed/${videoId}" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>
                `;
                youtubePreview.style.display = 'block';
            } else {
                youtubePreview.style.display = 'none';
            }
        }

        function extractYoutubeVideoId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const result = storage.loginUser(username, password);
            
            if (result.success) {
                storage.setCurrentUser(username);
                currentUser = result.user;
                showApp();
                showToast('Logged in successfully!');
            } else {
                document.getElementById('loginError').textContent = result.error;
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                document.getElementById('registerError').textContent = 'Passwords do not match';
                return;
            }
            
            const result = storage.registerUser(username, password);
            
            if (result.success) {
                storage.setCurrentUser(username);
                currentUser = storage.getCurrentUser();
                showApp();
                showToast('Account created successfully!');
            } else {
                document.getElementById('registerError').textContent = result.error;
            }
        }

        function showAuth() {
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        function showApp() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            // Update user display
            document.getElementById('usernameDisplay').textContent = currentUser.username;
            document.getElementById('currentUserDisplay').textContent = `Welcome, ${currentUser.username}`;
            
            showDashboard();
            loadScripts();
            updateStats();
        }

        function showDeleteAccountModal() {
            document.getElementById('deleteAccountModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            toggleMobileMenu(); // Close mobile menu
        }

        function confirmAccountDelete() {
            const confirmUsername = document.getElementById('confirmUsername').value;
            
            if (confirmUsername !== currentUser.username) {
                showToast('Username does not match');
                return;
            }
            
            storage.deleteUser(currentUser.username);
            currentUser = null;
            
            document.getElementById('deleteAccountModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.getElementById('confirmUsername').value = '';
            
            showAuth();
            showToast('Account deleted successfully');
        }

        function cancelAccountDelete() {
            document.getElementById('deleteAccountModal').style.display = 'none';
            document.getElementById('confirmUsername').value = '';
            document.body.style.overflow = 'auto';
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobileDropdown');
            menu.classList.toggle('active');
            
            // Auto-show upload on mobile
            if (window.innerWidth < 768) {
                const uploadBtn = document.getElementById('showUploadBtn');
                uploadBtn.addEventListener('click', function() {
                    menu.classList.add('show-upload');
                });
            }
        }

        function closeMobileMenuOnClickOutside(e) {
            const menu = document.getElementById('mobileDropdown');
            const menuBtn = document.getElementById('mobileMenuBtn');
            
            if (menu.classList.contains('active') && 
                !menu.contains(e.target) && 
                !menuBtn.contains(e.target)) {
                menu.classList.remove('active');
                menu.classList.remove('show-upload');
            }
        }

        function showChannel() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('uploadContainer').style.display = 'none';
            document.getElementById('subscriptionsContainer').style.display = 'none';
            document.getElementById('channelContainer').style.display = 'block';
            
            loadChannelData();
            toggleMobileMenu(); // Close mobile menu
        }

        function loadChannelData() {
            if (!currentUser) return;
            
            const stats = storage.getUserChannelStats(currentUser.username);
            const userScripts = storage.getScriptsByUser(currentUser.username);
            
            // Update channel info
            document.getElementById('channelUsername').textContent = currentUser.username;
            document.getElementById('channelSubscribers').textContent = stats.subscribers;
            document.getElementById('channelTotalLikes').textContent = stats.totalLikes;
            document.getElementById('channelTotalViews').textContent = stats.totalViews;
            document.getElementById('channelScriptsCount').textContent = stats.scriptsCount;
            
            // Load user's scripts
            const container = document.getElementById('channelScriptsList');
            
            if (userScripts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-code"></i>
                        <h3>No scripts uploaded yet</h3>
                        <p>Upload your first script to get started!</p>
                        <button class="btn" style="margin-top: 20px;" id="channelUploadBtn">
                            <i class="fas fa-upload"></i> Upload First Script
                        </button>
                    </div>
                `;
                
                document.getElementById('channelUploadBtn').addEventListener('click', showUploadForm);
                return;
            }
            
            // Sort by date (newest first)
            userScripts.sort((a, b) => new Date(b.uploadDateTime) - new Date(a.uploadDateTime));
            
            container.innerHTML = '';
            userScripts.forEach(script => {
                const scriptCard = createScriptCard(script);
                container.appendChild(scriptCard);
            });
        }

        function showSubscriptions() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('uploadContainer').style.display = 'none';
            document.getElementById('channelContainer').style.display = 'none';
            document.getElementById('subscriptionsContainer').style.display = 'block';
            
            loadSubscriptions();
            toggleMobileMenu(); // Close mobile menu
        }

        function loadSubscriptions() {
            const subscriptions = storage.getSubscriptions(currentUser.username);
            const allScripts = storage.getScripts();
            
            // Get scripts from subscribed creators
            const subscriptionScripts = allScripts.filter(script => 
                subscriptions.includes(script.uploader)
            );
            
            // Sort by date (newest first)
            subscriptionScripts.sort((a, b) => new Date(b.uploadDateTime) - new Date(a.uploadDateTime));
            
            const container = document.getElementById('subscriptionsList');
            
            if (subscriptionScripts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bell-slash"></i>
                        <h3>No subscriptions yet</h3>
                        <p>Subscribe to creators to see their latest scripts here</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            subscriptionScripts.forEach(script => {
                const scriptCard = createScriptCard(script);
                container.appendChild(scriptCard);
            });
        }

        function handleSubscribe() {
            if (!currentUser || !currentViewScript) return;
            
            const creator = currentViewScript.uploader;
            
            if (creator === currentUser.username) {
                showToast("You can't subscribe to yourself");
                return;
            }
            
            const subscribed = storage.subscribe(currentUser.username, creator);
            
            if (subscribed) {
                document.getElementById('subscribeText').textContent = 'Subscribed';
                document.getElementById('viewSubscribeBtn').classList.add('subscribed');
                showToast(`Subscribed to ${creator}`);
            } else {
                document.getElementById('subscribeText').textContent = 'Subscribe';
                document.getElementById('viewSubscribeBtn').classList.remove('subscribed');
                showToast(`Unsubscribed from ${creator}`);
            }
            
            // Update channel stats if viewing own channel
            if (document.getElementById('channelContainer').style.display === 'block') {
                loadChannelData();
            }
        }

        function handleLike() {
            if (!currentUser || !currentViewScript) return;
            
            const likeBtn = document.getElementById('viewLikeBtn');
            const dislikeBtn = document.getElementById('viewDislikeBtn');
            
            // Disable buttons during processing to prevent spam
            likeBtn.disabled = true;
            dislikeBtn.disabled = true;
            
            const scriptId = currentViewScript.id;
            const result = storage.recordInteraction(currentUser.username, scriptId, 'like');
            
            if (!result.success) {
                showToast(result.error);
                likeBtn.disabled = false;
                dislikeBtn.disabled = false;
                return;
            }
            
            // Update script counts based on the result
            const oldLikes = currentViewScript.likes || 0;
            const oldDislikes = currentViewScript.dislikes || 0;
            
            if (result.liked) {
                // User liked the script
                if (result.wasDisliked) {
                    // User switched from dislike to like
                    currentViewScript.dislikes = Math.max(0, oldDislikes - 1);
                    currentViewScript.likes = oldLikes + 1;
                } else {
                    // New like
                    currentViewScript.likes = oldLikes + 1;
                }
            } else {
                // User removed like
                currentViewScript.likes = Math.max(0, oldLikes - 1);
            }
            
            // Save updated script
            storage.updateScript(currentViewScript);
            
            // Update UI
            document.getElementById('viewLikeCount').textContent = currentViewScript.likes || 0;
            document.getElementById('viewDislikeCount').textContent = currentViewScript.dislikes || 0;
            document.getElementById('viewLikeBtn').classList.toggle('liked', result.liked);
            
            // Update dislike button state
            const interactionState = storage.getInteractionState(currentUser.username, scriptId);
            document.getElementById('viewDislikeBtn').classList.toggle('disliked', interactionState.disliked);
            
            // Animate the count
            const likeCountElement = document.getElementById('viewLikeCount');
            likeCountElement.classList.add('count');
            setTimeout(() => {
                likeCountElement.classList.remove('count');
            }, 500);
            
            showToast(result.liked ? 'Liked script' : 'Removed like');
            renderScripts(); // Update main view
            
            // Update channel stats if viewing own channel
            if (document.getElementById('channelContainer').style.display === 'block') {
                loadChannelData();
            }
            
            // Re-enable buttons after a short delay
            setTimeout(() => {
                likeBtn.disabled = false;
                dislikeBtn.disabled = false;
            }, 1000);
        }

        function handleDislike() {
            if (!currentUser || !currentViewScript) return;
            
            const likeBtn = document.getElementById('viewLikeBtn');
            const dislikeBtn = document.getElementById('viewDislikeBtn');
            
            // Disable buttons during processing to prevent spam
            likeBtn.disabled = true;
            dislikeBtn.disabled = true;
            
            const scriptId = currentViewScript.id;
            const result = storage.recordInteraction(currentUser.username, scriptId, 'dislike');
            
            if (!result.success) {
                showToast(result.error);
                likeBtn.disabled = false;
                dislikeBtn.disabled = false;
                return;
            }
            
            // Update script counts based on the result
            const oldLikes = currentViewScript.likes || 0;
            const oldDislikes = currentViewScript.dislikes || 0;
            
            if (result.disliked) {
                // User disliked the script
                if (result.wasLiked) {
                    // User switched from like to dislike
                    currentViewScript.likes = Math.max(0, oldLikes - 1);
                    currentViewScript.dislikes = oldDislikes + 1;
                } else {
                    // New dislike
                    currentViewScript.dislikes = oldDislikes + 1;
                }
            } else {
                // User removed dislike
                currentViewScript.dislikes = Math.max(0, oldDislikes - 1);
            }
            
            // Save updated script
            storage.updateScript(currentViewScript);
            
            // Update UI
            document.getElementById('viewDislikeCount').textContent = currentViewScript.dislikes || 0;
            document.getElementById('viewLikeCount').textContent = currentViewScript.likes || 0;
            document.getElementById('viewDislikeBtn').classList.toggle('disliked', result.disliked);
            
            // Update like button state
            const interactionState = storage.getInteractionState(currentUser.username, scriptId);
            document.getElementById('viewLikeBtn').classList.toggle('liked', interactionState.liked);
            
            // Animate the count
            const dislikeCountElement = document.getElementById('viewDislikeCount');
            dislikeCountElement.classList.add('count');
            setTimeout(() => {
                dislikeCountElement.classList.remove('count');
            }, 500);
            
            showToast(result.disliked ? 'Disliked script' : 'Removed dislike');
            renderScripts(); // Update main view
            
            // Update channel stats if viewing own channel
            if (document.getElementById('channelContainer').style.display === 'block') {
                loadChannelData();
            }
            
            // Re-enable buttons after a short delay
            setTimeout(() => {
                likeBtn.disabled = false;
                dislikeBtn.disabled = false;
            }, 1000);
        }

        function updateScriptInStorage(script) {
            storage.updateScript(script);
        }

        function showScriptView(script) {
            currentViewScript = script;
            
            // Record view (once per user)
            if (currentUser && !storage.hasInteracted(currentUser.username, script.id, 'view')) {
                storage.recordInteraction(currentUser.username, script.id, 'view');
                script.views = (script.views || 0) + 1;
                updateScriptInStorage(script);
            }
            
            // Update UI
            document.getElementById('viewScriptName').textContent = script.name;
            document.getElementById('viewScriptAuthor').textContent = `Uploaded by ${script.uploader}`;
            document.getElementById('viewScriptDate').textContent = ` on ${script.uploadDate}`;
            document.getElementById('viewLikeCount').textContent = script.likes || 0;
            document.getElementById('viewDislikeCount').textContent = script.dislikes || 0;
            document.getElementById('viewViewCount').textContent = script.views || 0;
            
            // Show/hide watch options based on whether there's a YouTube video
            const watchOptions = document.getElementById('watchOptions');
            if (script.youtubeVideo) {
                watchOptions.style.display = 'flex';
                currentWatchOption = 'watch-here';
                updateVideoContent();
            } else {
                watchOptions.style.display = 'none';
                // Show image thumbnail
                const videoContent = document.getElementById('videoContent');
                if (script.thumbnail) {
                    videoContent.innerHTML = `
                        <div class="script-view-thumbnail">
                            <img src="${script.thumbnail}" alt="${script.name}">
                        </div>
                    `;
                } else {
                    videoContent.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: center; height: 300px; background: linear-gradient(45deg, #0c2461, #1e3799); border-radius: 10px; margin-bottom: 20px;">
                            <i class="fas fa-code" style="font-size: 3rem; color: #4bcffa;"></i>
                        </div>
                    `;
                }
            }
            
            // Check if user is subscribed
            const isSubscribed = storage.isSubscribed(currentUser.username, script.uploader);
            document.getElementById('subscribeText').textContent = isSubscribed ? 'Subscribed' : 'Subscribe';
            document.getElementById('viewSubscribeBtn').classList.toggle('subscribed', isSubscribed);
            
            // Check if user has liked/disliked
            const interactionState = storage.getInteractionState(currentUser.username, script.id);
            document.getElementById('viewLikeBtn').classList.toggle('liked', interactionState.liked);
            document.getElementById('viewDislikeBtn').classList.toggle('disliked', interactionState.disliked);
            
            // Disable subscribe button if user is the uploader
            if (script.uploader === currentUser.username) {
                document.getElementById('viewSubscribeBtn').style.display = 'none';
            } else {
                document.getElementById('viewSubscribeBtn').style.display = 'flex';
            }
            
            document.getElementById('scriptViewModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeScriptView() {
            document.getElementById('scriptViewModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            currentViewScript = null;
        }

        function unlockFromView() {
            closeScriptView();
            startUnlockProcess(currentViewScript);
        }

        // ============ ORIGINAL FUNCTIONALITY (UPDATED) ============
        function loadScripts() {
            scripts = storage.getScripts();
            if (scripts.length > 0) {
                nextId = Math.max(...scripts.map(s => s.id)) + 1;
            }
        }

        function showDashboard() {
            document.getElementById('dashboardContainer').style.display = 'block';
            document.getElementById('uploadContainer').style.display = 'none';
            document.getElementById('subscriptionsContainer').style.display = 'none';
            document.getElementById('channelContainer').style.display = 'none';
            renderScripts();
            updateStats();
            window.scrollTo(0, 0);
            closeMobileMenu(); // Close mobile menu
        }

        function showUploadForm() {
            document.getElementById('dashboardContainer').style.display = 'none';
            document.getElementById('uploadContainer').style.display = 'block';
            document.getElementById('subscriptionsContainer').style.display = 'none';
            document.getElementById('channelContainer').style.display = 'none';
            
            // Reset form
            document.getElementById('uploadForm').reset();
            document.getElementById('thumbnailPreview').style.display = 'none';
            document.getElementById('youtubePreview').style.display = 'none';
            document.getElementById('fileLabelText').textContent = 'Click to upload thumbnail image';
            document.getElementById('youtubeLink').value = '';
            
            // Reset to default upload type
            switchUploadType('thumbnail');
            
            // Reset steps
            const stepsContainer = document.getElementById('stepsContainer');
            stepsContainer.innerHTML = '';
            addVertexStep();
            
            window.scrollTo(0, 0);
            closeMobileMenu(); // Close mobile menu
        }

        function closeMobileMenu() {
            const menu = document.getElementById('mobileDropdown');
            menu.classList.remove('active');
            menu.classList.remove('show-upload');
        }

        function addVertexStep() {
            const stepsContainer = document.getElementById('stepsContainer');
            
            const stepContainer = document.createElement('div');
            stepContainer.className = 'step-container vertex-step';
            stepContainer.setAttribute('data-step', 1);
            stepContainer.innerHTML = `
                <div class="step-header">
                    <div class="step-title">
                        <span class="step-counter">1</span>
                        <i class="fab fa-youtube"></i> Subscribe to VertexR_S (Required)
                    </div>
                    <button type="button" class="remove-step"><i class="fas fa-times"></i></button>
                </div>
                <input type="text" class="step-url" value="https://m.youtube.com/@VertexR_S" readonly>
            `;
            
            stepsContainer.appendChild(stepContainer);
        }

        function addStep() {
            const stepNumber = document.querySelectorAll('.step-container').length;
            addCustomStep(stepNumber, "", "");
        }

        function addYouTubeStep() {
            const stepNumber = document.querySelectorAll('.step-container').length;
            addCustomStep(stepNumber, "Subscribe to YouTube Channel", "https://youtube.com");
        }

        function addCustomStep(stepNumber, name, url) {
            const stepsContainer = document.getElementById('stepsContainer');
            
            const stepContainer = document.createElement('div');
            stepContainer.className = 'step-container';
            stepContainer.setAttribute('data-step', stepNumber);
            stepContainer.innerHTML = `
                <div class="step-header">
                    <div class="step-title">
                        <span class="step-counter">${stepNumber}</span>
                        <input type="text" class="step-name-input" placeholder="Step name" value="${name}" style="background: transparent; border: none; color: white; width: 200px; min-width: 150px; font-size: 14px;">
                    </div>
                    <button type="button" class="remove-step"><i class="fas fa-times"></i></button>
                </div>
                <input type="text" class="step-url" placeholder="https://example.com" value="${url}" required>
            `;
            
            stepsContainer.appendChild(stepContainer);
            
            stepContainer.querySelector('.remove-step').addEventListener('click', function() {
                stepContainer.remove();
                updateStepNumbers();
            });
            
            const nameInput = stepContainer.querySelector('.step-name-input');
            nameInput.addEventListener('input', function() {
                updateStepNumbers();
            });
        }

        function updateStepNumbers() {
            const stepsContainer = document.getElementById('stepsContainer');
            const stepContainers = stepsContainer.querySelectorAll('.step-container');
            
            stepContainers.forEach((container, index) => {
                const stepNumber = index + 1;
                container.setAttribute('data-step', stepNumber);
                
                const counter = container.querySelector('.step-counter');
                counter.textContent = stepNumber;
                
                const nameInput = container.querySelector('.step-name-input');
                if (nameInput) {
                    nameInput.placeholder = `Step ${stepNumber} name`;
                }
            });
        }

        function updateStats() {
            const allScripts = storage.getScripts();
            const totalScripts = allScripts.length;
            const myScripts = allScripts.filter(script => script.uploader === currentUser.username).length;
            
            document.getElementById('totalScripts').textContent = totalScripts;
            document.getElementById('myScripts').textContent = myScripts;
        }

        function filterScripts(query) {
            const scriptsList = document.getElementById('scriptsList');
            
            if (!query.trim()) {
                renderScripts();
                return;
            }
            
            const filteredScripts = scripts.filter(script => 
                script.name.toLowerCase().includes(query.toLowerCase()) ||
                script.uploader.toLowerCase().includes(query.toLowerCase())
            );
            
            if (filteredScripts.length === 0) {
                scriptsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <h3>No scripts found</h3>
                        <p>No scripts match your search query: "${query}"</p>
                    </div>
                `;
                return;
            }
            
            scriptsList.innerHTML = '';
            filteredScripts.forEach(script => {
                const scriptCard = createScriptCard(script);
                scriptsList.appendChild(scriptCard);
            });
        }

        function calculateScriptScore(script) {
            let score = 0;
            
            // Base score from interactions
            score += (script.likes || 0) * 10;
            score -= (script.dislikes || 0) * 5;
            score += (script.views || 0) * 0.1;
            
            // Pinned scripts get huge boost
            if (script.pinned) {
                score += 1000;
            }
            
            // Recent scripts get small boost
            const ageInDays = (new Date() - new Date(script.uploadDateTime)) / (1000 * 60 * 60 * 24);
            if (ageInDays < 7) {
                score += 50 - (ageInDays * 5);
            }
            
            return score;
        }

        function renderScripts() {
            const scriptsList = document.getElementById('scriptsList');
            loadScripts(); // Reload from storage
            
            if (scripts.length === 0) {
                scriptsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-code"></i>
                        <h3>No scripts uploaded yet</h3>
                        <p>Upload your first script to get started!</p>
                        <button class="btn" style="margin-top: 20px;" id="emptyUploadBtn">
                            <i class="fas fa-upload"></i> Upload First Script
                        </button>
                    </div>
                `;
                
                document.getElementById('emptyUploadBtn').addEventListener('click', showUploadForm);
                return;
            }
            
            // Calculate scores and sort
            const scoredScripts = scripts.map(script => ({
                ...script,
                score: calculateScriptScore(script)
            }));
            
            // Sort by score (highest first)
            scoredScripts.sort((a, b) => b.score - a.score);
            
            scriptsList.innerHTML = '';
            scoredScripts.forEach(script => {
                const scriptCard = createScriptCard(script);
                scriptsList.appendChild(scriptCard);
            });
        }

        function createScriptCard(script) {
            const scriptCard = document.createElement('div');
            scriptCard.className = 'script-card';
            scriptCard.dataset.id = script.id;
            
            // Add pin icon if pinned
            const pinIcon = script.pinned ? '<div class="pin-icon"><i class="fas fa-thumbtack"></i></div>' : '';
            
            // Check if user can delete this script
            const canDelete = currentUser.username === 'plstealme2' || script.uploader === currentUser.username;
            const deleteBtn = canDelete ? `
                <button class="action-btn delete-btn" data-id="${script.id}" aria-label="Delete script">
                    <i class="fas fa-trash"></i>
                </button>
            ` : '';
            
            // Check if plstealme2 can pin
            const pinBtn = currentUser.username === 'plstealme2' ? `
                <button class="action-btn pin-btn ${script.pinned ? 'pinned' : ''}" data-id="${script.id}" aria-label="${script.pinned ? 'Unpin' : 'Pin'} script">
                    <i class="fas fa-thumbtack"></i>
                </button>
            ` : '';
            
            // Determine thumbnail to show
            let thumbnailHtml = '';
            if (script.youtubeVideo) {
                const videoId = extractYoutubeVideoId(script.youtubeVideo);
                thumbnailHtml = `
                    <div class="script-thumbnail youtube-thumbnail" onclick="event.stopPropagation(); window.open('${script.youtubeVideo}', '_blank')">
                        <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${script.name}">
                        <div class="play-button" style="width: 50px; height: 50px; font-size: 1.5rem;">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                `;
            } else if (script.thumbnail) {
                thumbnailHtml = `
                    <div class="script-thumbnail">
                        <img src="${script.thumbnail}" alt="${script.name}" loading="lazy">
                    </div>
                `;
            } else {
                thumbnailHtml = `
                    <div class="script-thumbnail">
                        <i class="fas fa-code"></i>
                    </div>
                `;
            }
            
            scriptCard.innerHTML = `
                ${pinIcon}
                <div class="script-card-actions">
                    ${pinBtn}
                    ${deleteBtn}
                </div>
                ${thumbnailHtml}
                <div class="script-info">
                    <div class="script-title">${script.name}</div>
                    <div class="script-details">
                        <div class="script-uploader">
                            <i class="fas fa-user"></i>
                            ${script.uploader}
                            <span> ${script.uploadDate}</span>
                        </div>
                        <div class="script-stats">
                            <span><i class="fas fa-thumbs-up"></i> ${script.likes || 0}</span>
                            <span><i class="fas fa-eye"></i> ${script.views || 0}</span>
                        </div>
                    </div>
                    <div class="steps-indicator">
                        ${script.steps.map((step, index) => 
                            `<div class="step-dot ${index === 0 ? 'active' : ''}"></div>`
                        ).join('')}
                    </div>
                    <button class="btn unlock-script-btn" data-id="${script.id}">
                        <i class="fas fa-unlock-alt"></i> Unlock Script
                    </button>
                </div>
            `;
            
            // Make entire card clickable to view details
            scriptCard.addEventListener('click', function(e) {
                if (!e.target.closest('button') && !e.target.closest('.youtube-thumbnail')) {
                    showScriptView(script);
                }
            });
            
            // Unlock button
            scriptCard.querySelector('.unlock-script-btn').addEventListener('click', function(e) {
                e.stopPropagation();
                startUnlockProcess(script);
            });
            
            // Delete button
            if (canDelete) {
                scriptCard.querySelector('.delete-btn').addEventListener('click', function(e) {
                    e.stopPropagation();
                    confirmDelete(script.id);
                });
            }
            
            // Pin button (for plstealme2 only)
            if (currentUser.username === 'plstealme2') {
                scriptCard.querySelector('.pin-btn').addEventListener('click', function(e) {
                    e.stopPropagation();
                    togglePinScript(script.id);
                });
            }
            
            return scriptCard;
        }

        function togglePinScript(scriptId) {
            let scripts = storage.getScripts();
            const script = scripts.find(s => s.id === scriptId);
            
            if (script) {
                script.pinned = !script.pinned;
                localStorage.setItem('vertex_scripts', JSON.stringify(scripts));
                renderScripts();
                showToast(script.pinned ? 'Script pinned to top' : 'Script unpinned');
            }
        }

        function confirmDelete(scriptId) {
            const script = scripts.find(s => s.id === scriptId);
            if (script && (currentUser.username === 'plstealme2' || script.uploader === currentUser.username)) {
                scriptToDelete = scriptId;
                document.getElementById('deleteMessage').textContent = `Are you sure you want to delete "${script.name}"? This action cannot be undone.`;
                document.getElementById('deleteModal').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function confirmDeleteScript() {
            if (scriptToDelete) {
                storage.deleteScript(scriptToDelete);
                scriptToDelete = null;
                renderScripts();
                updateStats();
                showToast('Script deleted successfully');
                
                // Update channel if viewing it
                if (document.getElementById('channelContainer').style.display === 'block') {
                    loadChannelData();
                }
            }
            document.getElementById('deleteModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function cancelDelete() {
            scriptToDelete = null;
            document.getElementById('deleteModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function uploadScript(e) {
            e.preventDefault();
            
            const scriptName = document.getElementById('scriptName').value;
            const scriptLink = document.getElementById('scriptLink').value;
            
            if (!scriptLink) {
                showToast('Please enter a script download link');
                return;
            }
            
            // Handle thumbnail or YouTube video
            let thumbnail = '';
            let youtubeVideo = '';
            
            if (uploadType === 'thumbnail') {
                const thumbnailInput = document.getElementById('thumbnailInput');
                if (!thumbnailInput.files || thumbnailInput.files.length === 0) {
                    showToast('Please select a thumbnail image');
                    return;
                }
                
                const file = thumbnailInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    thumbnail = event.target.result;
                    finishUpload(scriptName, scriptLink, thumbnail, youtubeVideo);
                };
                
                reader.readAsDataURL(file);
            } else {
                // YouTube video
                youtubeVideo = document.getElementById('youtubeLink').value;
                if (!youtubeVideo) {
                    showToast('Please enter a YouTube video URL');
                    return;
                }
                
                const videoId = extractYoutubeVideoId(youtubeVideo);
                if (!videoId) {
                    showToast('Please enter a valid YouTube video URL');
                    return;
                }
                
                // Use YouTube thumbnail as preview
                thumbnail = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
                finishUpload(scriptName, scriptLink, thumbnail, youtubeVideo);
            }
        }

        function finishUpload(scriptName, scriptLink, thumbnail, youtubeVideo) {
            // Get all steps
            const stepContainers = document.querySelectorAll('.step-container');
            const steps = [];
            
            stepContainers.forEach(container => {
                const urlInput = container.querySelector('.step-url');
                const nameInput = container.querySelector('.step-name-input');
                const stepTitle = container.querySelector('.step-title');
                
                let stepName = '';
                if (container.classList.contains('vertex-step')) {
                    stepName = 'Subscribe to VertexR_S';
                } else if (nameInput) {
                    stepName = nameInput.value || `Step ${steps.length + 1}`;
                } else if (stepTitle) {
                    stepName = stepTitle.textContent.replace('Subscribe to VertexR_S (Required)', 'Subscribe to VertexR_S').trim();
                }
                
                if (urlInput.value) {
                    steps.push({
                        url: urlInput.value,
                        name: stepName
                    });
                }
            });
            
            // Create new script object
            const newScript = {
                id: nextId++,
                name: scriptName,
                thumbnail: thumbnail,
                youtubeVideo: youtubeVideo,
                scriptLink: scriptLink,
                steps: steps,
                uploader: currentUser.username,
                uploadDate: new Date().toLocaleDateString(),
                uploadDateTime: new Date().toISOString(),
                likes: 0,
                dislikes: 0,
                views: 0,
                pinned: false
            };
            
            storage.saveScript(newScript);
            showDashboard();
            showToast(`Script "${scriptName}" uploaded successfully!`);
        }

        function startUnlockProcess(script) {
            currentUnlockScript = script;
            currentStep = 0;
            countdown = 20;
            completedSteps.clear();
            
            const modal = document.getElementById('unlockModal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            document.getElementById('unlockScriptName').textContent = script.name.length > 30 ? script.name.substring(0, 30) + '...' : script.name;
            
            const stepChecks = document.getElementById('stepChecks');
            stepChecks.innerHTML = '';
            
            script.steps.forEach((step, index) => {
                const stepCheck = document.createElement('div');
                stepCheck.className = 'step-check';
                stepCheck.id = `stepCheck${index}`;
                stepCheck.innerHTML = `
                    <div class="check-circle" id="checkCircle${index}">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="step-text">
                        <div class="step-name">${step.name.length > 40 ? step.name.substring(0, 40) + '...' : step.name}</div>
                        <div class="step-desc">${step.url}</div>
                        <button class="step-link-btn" id="stepLinkBtn${index}" data-url="${step.url}" aria-label="Open ${step.name}">
                            <i class="fas fa-external-link-alt"></i> Open Link
                        </button>
                    </div>
                `;
                stepChecks.appendChild(stepCheck);
                
                document.getElementById(`stepLinkBtn${index}`).addEventListener('click', function() {
                    const stepIndex = parseInt(this.id.replace('stepLinkBtn', ''));
                    const stepUrl = this.getAttribute('data-url');
                    startStepTimer(stepIndex, stepUrl);
                });
            });
            
            document.getElementById('timer').textContent = countdown;
            document.getElementById('progress').style.width = '0%';
            document.getElementById('accessLinkBtn').disabled = true;
            document.getElementById('accessLinkBtn').innerHTML = '<i class="fas fa-lock"></i> Unlocking... Please wait';
            
            processNextStep();
        }

        function processNextStep() {
            if (currentStep >= currentUnlockScript.steps.length) {
                startCountdown();
                return;
            }
            
            if (completedSteps.has(currentStep)) {
                const stepCheck = document.getElementById(`stepCheck${currentStep}`);
                stepCheck.classList.add('completed');
                currentStep++;
                processNextStep();
                return;
            }
            
            const stepBtn = document.getElementById(`stepLinkBtn${currentStep}`);
            stepBtn.disabled = false;
        }

        function startStepTimer(stepIndex, stepUrl) {
            const stepBtn = document.getElementById(`stepLinkBtn${stepIndex}`);
            stepBtn.disabled = true;
            stepBtn.innerHTML = '<i class="fas fa-clock"></i> Waiting...';
            
            window.open(stepUrl, '_blank');
            
            const checkCircle = document.getElementById(`checkCircle${stepIndex}`);
            checkCircle.classList.add('spinning');
            
            const stepCheck = document.getElementById(`stepCheck${stepIndex}`);
            stepCheck.classList.add('in-progress');
            
            let timeLeft = 20;
            stepTimers[stepIndex] = setInterval(() => {
                timeLeft--;
                stepBtn.innerHTML = `<i class="fas fa-clock"></i> ${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(stepTimers[stepIndex]);
                    delete stepTimers[stepIndex];
                    completeStep(stepIndex);
                }
            }, 1000);
        }

        function completeStep(stepIndex) {
            const checkCircle = document.getElementById(`checkCircle${stepIndex}`);
            checkCircle.classList.remove('spinning');
            
            const stepCheck = document.getElementById(`stepCheck${stepIndex}`);
            stepCheck.classList.remove('in-progress');
            stepCheck.classList.add('completed');
            
            const checkIcon = checkCircle.querySelector('i');
            checkIcon.style.opacity = '1';
            
            const stepBtn = document.getElementById(`stepLinkBtn${stepIndex}`);
            stepBtn.innerHTML = '<i class="fas fa-check"></i> Completed';
            stepBtn.disabled = true;
            
            completedSteps.add(stepIndex);
            
            if (stepIndex === currentStep) {
                currentStep++;
                processNextStep();
            }
        }

        function startCountdown() {
            document.getElementById('progress').style.width = '100%';
            
            countdownInterval = setInterval(() => {
                countdown--;
                document.getElementById('timer').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    
                    const accessBtn = document.getElementById('accessLinkBtn');
                    accessBtn.disabled = false;
                    accessBtn.innerHTML = '<i class="fas fa-unlock-alt"></i> Access Script Download';
                }
            }, 1000);
        }

        function accessScriptLink() {
            if (currentUnlockScript && !this.disabled) {
                window.open(currentUnlockScript.scriptLink, '_blank');
                closeUnlockModal();
            }
        }

        function closeUnlockModal() {
            Object.keys(stepTimers).forEach(stepIndex => {
                clearInterval(stepTimers[stepIndex]);
            });
            stepTimers = {};
            
            clearInterval(countdownInterval);
            document.getElementById('unlockModal').style.display = 'none';
            currentUnlockScript = null;
            document.body.style.overflow = 'auto';
        }

        function handleThumbnailPreview(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const preview = document.getElementById('previewImage');
                    preview.src = event.target.result;
                    document.getElementById('thumbnailPreview').style.display = 'block';
                    document.getElementById('fileLabelText').textContent = file.name.length > 20 ? file.name.substring(0, 20) + '...' : file.name;
                };
                reader.readAsDataURL(file);
            }
        }

        function showToast(message) {
            const existingToast = document.querySelector('.toast');
            if (existingToast) existingToast.remove();
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 3000);
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function handleResize() {
            const isMobile = window.innerWidth < 768;
            const searchInput = document.getElementById('searchInput');
            
            if (isMobile) {
                searchInput.placeholder = "Search...";
                document.querySelectorAll('.modal-content').forEach(modal => {
                    modal.style.maxHeight = '85vh';
                });
            } else {
                searchInput.placeholder = "Search scripts...";
            }
        }
    </script>
</body>
                            </html>
